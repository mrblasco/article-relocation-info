
```{r, include = FALSE}
library(dplyr)
library(kableExtra)
library(ggplot2)
#source("R/theme.R")
theme_set(theme_minimal(base_size = 11))
```

```{r rologit, include = FALSE, cache = TRUE}
source("analysis_mean_rank.R")
source("analysis_rologit.R")
```

# Results

## Treatment Effects 

### Perceived fairness in the control group

Figure \@ref(fig:toprank) shows that, when asked to pick the fairest option, without information on the number of asylum seekers under each relocation scheme (i.e., the 'No Info' group), 76% of respondents selected some form of relocation as fairest, with a slight preference for relocation by GDP (39%) over relocation by population (35%). Only a minority (26%) considered no relocation at all to be the fairest option. A one-sample proportion test shows that this result is significantly lower (p<0.01) than the 33% expected if individuals were ranking alternatives at random or were indifferent among the options. Therefore, this evidence supports our hypothesis (H1) that the public perceives proportional relocation schemes as fairest. 

```{r toprank, fig.cap = cap, fig.width = 7, fig.height = 3.5}
cap <- paste(
    "Perceptions of the fairest relocation scheme in the Control treatment, with no information about the corresponding asylum applications"
)
readRDS(file.path("results", "figures", "top_rank_no_info.rds"))
```

However, there was considerable variation across countries. In Germany, only 58% in the ‘No info’ group ranked some form of relocation as the fairest option, which is the lowest share among the selected countries, while in Greece the proportion was highest at 87%. Relocation by GDP was commonly perceived as the fairest in Bulgaria (53%), Greece (48%) and Spain (48%), but not in Germany (19%) or Sweden (27%). Views on relocation by population also varied: the share of respondents assigning it the top rank range from 24% in Poland to 45% in Italy. These stark differences suggest that country-specific conditions, such as the political climate, refugee situation, and socio-economic differences, play a significant role in shaping public perceptions of fairness.

### Treatment effects on Perceived Fairness

Table XX shows highly significant associations between the top ranked relocation option and treatment assignment from separate Chi-squared tests within each country. Only the association within Greece and France was statistically insignificant (p = 0.13, for both). After applying Bonferroni correction, the result for Spain remains only marginally significant (p. = 0.073). Overall, however, these results confirm a robust treatment effect in most countries, as hypothesized. 


```{r, fig.width = 7, fig.height = 5, fig.cap = cap}
cap <- "TBA"
readRDS(file.path("results", "figures", "mean_rank.rds"))
```

## Heterogenous effects 

### Political orientation 

Figure \@ref(fig:political) illustrates that the magnitude of the information effect on perceived fairness is heavily influenced by respondents' political orientation. The figure presents the intercepts and slopes of the rank-ordered logit model discussed above for each treatment condition. Since we centered the expected number of asylum seekers for each alternative, the model's intercepts for the type of relocation (by GDP or by population) represent the average treatment effect on the probability of ranking the scheme as fairer than having no relocation at all.

Looking at the intercepts, which compare alternative schemes at the average number of asylum seekers, we find that respondents consistently assign a "premium" to relocation: the intercept is significantly greater than zero in all conditions. This premium is largest for left-leaning respondents, followed by center-leaning, and smallest for right-leaning respondents. Moreover, intercepts do not differ significantly across treatments, except in the case of relocation by population, where the Absolute condition reduces the effect of proportional relocation by population compared to no relocation. 

Conversely, we observe significant heterogeneity in the size of the effect of the provided information about expected conseuqneces of each regime (i.e., the slope). In all models, alternatives with higher numbers of asylum seekers were associated with lower fairness. However, absolute and relative information significantly amplified sensitivity to the number of asylum seekers, particularly among centre and right respondents. The differences in responses between left- and right-leaning respondents were particularly pronounced in the absolute information condition. Here, right-leaning respondents showed the strongest negative reaction to higher numbers of asylum seekers (−0.76), while left-leaning respondents were much less sensitive (−0.35), highlighting a stark partisan gap in fairness perceptions.

```{r political, fig.cap = "Political orientation", fig.asp = 1}
results[["political_right_cut"]]$plot
```

## Fair share 

Figure \@ref(fig:fair) illustrates the heteogeneity of the effects between individuals who reported the number of migrants in their own country as "fair" or "too low" vs those perceiving it as "too high". 

Both groups show higher perceived fairness for relocation schemes compared to no relocation, with all intercepts significantly positive. However, among respondents reporting that the current share is “fair or too low,” we do not detect a meaningful average treatment effect of framing: support is lowest under the Absolute condition, particularly for relocation by population (Estimate = 0.56, SE = 0.08) compared with GDP-based relocation (Estimate = 0.73, SE = 0.08). By contrast, in the group perceiving the share as “too high,” the Absolute framing significantly reduced support relative to Control for both GDP and population schemes (GDP: 0.29 vs. 0.61; Population: 0.38 vs. 0.65), with Relative framing falling in between and not significantly different from Control.

At the same time, for respondents reporting a “too high” share, we observe strong and significant heterogeneous effects of the expected number of asylum seekers on each relocation scheme. The negative impact of a one standard deviation increase in asylum seekers was largest under the Absolute condition (Estimate = -0.79, SE = 0.04), followed by the Relative condition (-0.56, SE = 0.04), and smallest in the Control group (-0.19, SE = 0.04). This corresponds to a difference of approximately 0.60 between Absolute and Control, substantially larger than the corresponding difference in the “fair or too low” group, which is 0.26.

```{r fair, fig.cap = "Fair share", fig.asp = 1}
results[["fair_share"]]$plot
```

```{r eval = FALSE}
results[["fair_share"]]$coeffs %>% 
    mutate(cis = sprintf("[%.2f, %.2f]", conf.low, conf.high)) %>%
    arrange(group, term, condition) %>%
    select(group, term, condition, Estimate = estimate, SE = std.error, "95% CI" = cis) %>%
    mutate(term = ifelse(row_number() == 1, as.character(term), ""), 
            .by = c(group, term)) %>%
    mutate(group = ifelse(row_number() == 1, as.character(group), ""), .by = group) %>%
    kbl(
        digits = 2,
        caption = "Regression coefficients and 95% CIs",
        caption.short = "Fair share heterogeneity"
    ) %>% 
    kable_styling() %>% 
    column_spec(1:2, bold = TRUE)
```

### Trust in the EU

Figure \@ref(fig:trust) illustrates ... 

```{r trust, fig.cap = "Fair share", fig.asp = 1}
results[["trust_eu_cut"]]$plot
```

```{r, eval = FALSE}
results[["trust_eu_cut"]]$coeffs %>% 
    mutate(cis = sprintf("[%.2f, %.2f]", conf.low, conf.high)) %>%
    arrange(group, term, condition) %>%
    select(group, term, condition, Estimate = estimate, SE = std.error, "95% CI" = cis) %>%
    mutate(term = ifelse(row_number() == 1, as.character(term), ""), 
            .by = c(group, term)) %>%
    mutate(group = ifelse(row_number() == 1, as.character(group), ""), .by = group) %>%
    kbl(
        digits = 2,
        caption = "Regression coefficients and 95% CIs",
        caption.short = "Fair share heterogeneity"
    ) %>% 
    kable_styling() %>% 
    column_spec(1:2, bold = TRUE)
```
